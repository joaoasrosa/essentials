<html prefix="og: http://ogp.me/ns#">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=600">
<base href="https://essentials.xebia.com" >
<title> Comment with care

 - Xebia Essentials</title>
<link href="//fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet" type="text/css">
<link href="style/style.css" type="text/css" rel="stylesheet">
<style type="text/css"></style>
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.css">
<link href="/index.html" rel="up">
<link href="/cards" rel="index">
<meta property="og:url" content="https://essentials.xebia.com/comment-with-care/">
<meta property="og:title" content="Comment with care

">
<meta property="og:summary" content="

  Don’t document bad code – rewrite it
  Don’t repeat the code – clarify its intent
  Document surprises and workarounds
  Make every comment count


">
<meta property="og:description" content="

  Don’t document bad code – rewrite it
  Don’t repeat the code – clarify its intent
  Document surprises and workarounds
  Make every comment count


">
<meta content="" property="og:site_name">
<meta content="website" property="og:type">
<meta content="en_US" property="og:locale">
<meta content="//essentials.xebia.com/img/XebiaEssentialsCards.jpg" property="og:image">
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta content="The Xebia Essentials is a deck of flash cards about software craftsmanship." property="og:config">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@xebia" />
<meta name="twitter:description" content="

  Don’t document bad code – rewrite it
  Don’t repeat the code – clarify its intent
  Document surprises and workarounds
  Make every comment count


" />
<meta name="apple-itunes-app" content="app-id=883300245, app-argument=https:https://essentials.xebia.com/comment-with-care/">
<link rel="apple-touch-icon" href="touch-icon-iphone.png">
<link rel="apple-touch-icon" sizes="76x76" href="touch-icon-ipad.png">
<link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png">
<link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png">

  <script async="" src="//www.google-analytics.com/analytics.js"></script><script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-45163453-1', 'xebia.com');
  ga('send', 'pageview');
  function addListener(element, type, callback) {
    if (element.addEventListener) element.addEventListener(type, callback);
    else if (element.attachEvent) element.attachEvent('on' + type, callback);
  }
  function trackAClick(elementId, type, label) {
    var elem = document.getElementById(elementId);
    addListener(elem, 'click', function() {
      ga('send', 'event', type, 'click', label);
    });
  }
</script>

</head>

  <body>
    <div id="main">
      <div id="top"></div>

<div id="masthead" style="background-color:

  
    #F80068
  

  

  

  

  

" />
  <para>Comment with care

</para>

  <div class="sharing">
    <a target="_blank" rel="nofollow" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3Ahttps://essentials.xebia.com/comment-with-care/"> <i class="fa fa-linkedin"></i></a>
    <a target="_blank" rel="nofollow" href="http://twitter.com/share?text=Comment with care

&amp;url=https%3Ahttps://essentials.xebia.com/comment-with-care/"><i class="fa fa-twitter"></i></a>
    <a target="_blank" rel="nofollow" href="https://plus.google.com/share?url=https%3Ahttps://essentials.xebia.com/comment-with-care/"><i class="fa fa-google-plus-square"></i></a>
    <a target="_blank" rel="nofollow" href="http://www.facebook.com/sharer.php?t=Comment with care

&amp;u=https%3Ahttps://essentials.xebia.com/comment-with-care/"><i class="fa fa-facebook"></i></a>
  </div>
</div>

      <div id="body">
        <div class="wiki-content" id="main-content">
  
<h3 id="motivation">Motivation</h3>

<p>Getting the comments right is as hard (and important) as getting the source code right. Having too many comments in a file can be as detrimental to maintainability as having too few [citation needed], comments can be useless and the worst are incorrect or misleading.</p>

<p>Source code comments can assert intellectual property ownership and licensing terms.</p>

<h3 id="applicability">Applicability</h3>

<p>Every modern programming language I’m aware of supports source code comments.</p>

<h3 id="application">Application</h3>

<ul>
  <li>In an object-oriented language such as Java (1), it’s fair to demand a type-level JavaDoc header that describes the intent and responsibility of the class or interface on every public or protected type.</li>
  <li>On APIs intended for use by others, every public method and field should be appropriately documented.</li>
  <li>Use the standard documentation system for the platform. In Python, that’s doc strings. In Java, that’s JavaDoc. The standard documentation system is not only familiar to humans, most IDEs and some editors know how to read it too. As obvious as this may seem, I more than once had the displeasure of using a closed-source API documented using a proprietary HTML layout not in any way resembling standard JavaDoc. It was painful.</li>
</ul>

<p>Guidelines aside, whenever you find yourself wondering: “I wonder whether this’ll make sense to me later”, you know it’s time for a comment. Ensure the comment contains information that cannot be obtained by simply reading the code itself.</p>

<p>Beware if inline comments, though! Most of the time when you find yourself adding comments to a particular line of code, it’s time to move that code to it’s own function or method and provide that with a descriptive name.</p>

<h3 id="consequences">Consequences</h3>

<p>Effective use of source code comments improves the maintainability of program code. Coming back to your or someone else’s code to add a feature or carry out a fix will take a matter of minutes or hours, rather than days or weeks.</p>

<h3 id="samples">Samples</h3>

<h1 id="dont-document-bad-code---rewrite-it">Don’t document bad code - rewrite it.</h1>

<p>The <a href="http://en.wikipedia.org/wiki/Comment_%28computer_programming%29">Wikipedia article on commenting</a> ascribes this aphorism to The Elements of Programming Style [3]. It’s a good general guideline, but it may not always be feasible, especially in maintenance projects.</p>

<h1 id="dont-repeat-the-code---clarify-its-intent">Don’t repeat the code - clarify its intent.</h1>

<p>Code Complete [1] illustrates this with a nice example. Which is more clarifying?</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// If account flag is zero
if (accountFlag == 0) ...
</code></pre></div></div>

<p>or</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// If establishing a new account
if (accountFlag == 0) ...
</code></pre></div></div>

<p>Maybe the intent can be clarified just as much without a comment:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (establishNewAccount()) ...

private boolean establishNewAccount() {
    return accountFlag == 0;
}
</code></pre></div></div>

<h1 id="document-surprises-and-workarounds">Document surprises and workarounds.</h1>

<p>“Surprises and workarounds” is deliberately vague, as it’s very hard to qualify. A common scenario is that you add a special case in a method to fix a bug or when you find out that a library behaves differently than you thought it would because it bites you during testing.</p>

<p>An example of this is when I found out that a Java 1.5 ThreadPoolExecutor with a corePoolSize of 0, a maxPoolSize of 50 and an unbounded task queue does not idle at 0 threads and execute at 50, but rather, starts 0 threads and executes nothing at all. When I dug into this, I found out that Java 1.5 has no way to make a ThreadPoolExecutor idle at 0 threads (Java 1.6 does) and that in both versions maxPoolSize is meaningless with an unbounded queue. I put a short note above the variable declaration to benefit any maintenance programmer that needs to adjust the pool sizes.</p>

<p>A special case of this is where source code analysis tools report a false positive. A great example of this is the <a href="http://digitaloffense.net/tools/debian-openssl/">Debian OpenSSL</a> fiasco of a few years back. The random number generator contained what appears to be bad use of uninitialized memory (and was reported as such by code analysis tools), but which was essential to seeding the random number generator. Someone removed the line in a clean-up effort and the result was two years’ worth of SSL certificates each of which could be brute-forced in at most 32768 attempts.</p>

<h1 id="make-every-comment-count">Make every comment count.</h1>

<p>Excessive comments are just clutter.</p>

<h1 id="good-the-javautilconcurrent-package">Good: The java.util.concurrent package</h1>

<p>The JavaDoc comments in the java.util.concurrent package are outstanding. They’re short and to the point where possible, meticulously detailed where required.</p>

<h1 id="bad-eclipse-getters-and-setters">Bad: Eclipse getters and setters</h1>

<p>Eclipse’s default template for the JavaDoc comment on getters and setters is horrible.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/**
 * @param foo the foo to set
 */
public void setFoo(String foo) {
    this.foo = foo
};

/**
 * @return the foo
 */
public String getFoo() {
    return foo
};
</code></pre></div></div>

<p>These comments are grammatically ugly. Worse, the comments don’t add any value: we know what a getter or setter does and if a method does something else it shouldn’t masquerade as a getter or setter in the first place. Don’t generate comments using this template, just leave them out.</p>

<p>If your architect/analysis tool/standards body won’t let you get away with undocumented getters and setters, at least replace the template by something grammatically correct.</p>

<h1 id="good-unit-bounds-resolution-precision">Good: Unit, bounds, resolution, precision</h1>

<p>When dealing with measurements and amounts, make sure the unit, resolution and bounds are apparent. It’s often possible and desirable to make this information programmatically available, such as with java.util.Currency or JSR-275. Failing that, you can resort to code comments such as in the next example.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;xsd:element name="admission" type="xsd:dateTime"&gt;
    &lt;xsd:annotation&gt;
        &lt;xsd:documentation&gt;
            The date and time of admission. Precision is in minutes, the
            seconds are always 00. UTC offset is not included, all values
            are in the Europe/Amsterdam time zone.
        &lt;/xsd:documentation&gt;
    &lt;/xsd:annotation&gt;
&lt;/xsd:element&gt;
</code></pre></div></div>

<p>The xsd:dateTime has a resolution in seconds (optionally milliseconds) and an optional UTC offset. The UTC offset is required to unambiguously pinpoint a calendar date and time on the time continuum. If the actual offset is unavailable, a time zone is the next best thing. The fact that we”re using an xsd:dateTime instead of an xsd:string has documentary value in and of itself.</p>

<h3 id="references">References</h3>

<ol>
  <li>Code Complete (Steve McConnell, Microsoft Press), pages 777-817.</li>
  <li>The Pragmatic Programmer (Hunt/Thomas, Addison Wesley), page 249-251.</li>
  <li>The Elements of Programming Style (Kernighan/Plauger, Mcgraw-Hill)</li>
</ol>

<h3 id="footnotes">Footnotes</h3>

<ol>
  <li>Some argue Java isn’t an object oriented language. It’s close enough for the purposes of this article.</li>
</ol>


</div>

        
          <h3>The Xebia Essentials Cards</h3>
<div>
  This page is part of the <a rel="collection" href="/index.html">Xebia Essentials</a>, a pack of flash cards about Software Development Done Right. You can get your own deck of Essentials cards in the Xebia store.
</div>
<div class="buynow">
  <a href="http://xebia.com/books/xebia-essentials?utm_source=footer&utm_medium=web&utm_campaign=essentials" class="buybutton"><i class="fa fa-shopping-cart"></i> Buy Now</a></div>
  <br clear='left'/>

        
        <div id="footer">
  If you have any questions, remarks or suggestions, please feel free to send an email to <a href="mailto:essentials@xebia.com">essentials@xebia.com</a>.
</div>

        <div id="copyright">
  Copyright © 2011-2020 Xebia
  <a rel="author" href="http://www.xebia.com" type="text/html">
    <img alt="Xebia" height="20" width="60" src="//essentials.xebia.com/img/logo_xebia-120x40.jpg" align="right">
  </a>
</div>

      </div>
    </div>
  </body>
</html>
